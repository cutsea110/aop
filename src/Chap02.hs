module Chap02 where

-- | Ex 2.1
-- f . u = f
--        f          u
-- B <------- A <-------- A
-- B <------------------- A
--            f
--
-- f は任意なので f として id_A をとる
--
--  id_A . u
-- == {- f . u = f -}
--  id_A
--
-- 一方 id_A は単位元なので
--  id_A . u
-- == {- id_A は単位元 -}
--  u
--
-- ゆえに id_A . u == id_A かつ id_A . u == u なので u == id_A
--

-- | Ex 2.2
--
--        f
--    <---------
--  A ---------> B
--  |     h     /
--  |          /
-- g|         /k
--  |        /
--  v       /
--  C<-----/
--
-- k . h . f . h : C <- A
-- g . k . h     : type error
--
-- | Ex 2.3
--
-- Def. r : A <- B は r . r' = id_A なる r': B <- A が存在するならレトラクションという
--          r
--     A <----- B
--     ^       ^
--     |      /
--   id|     / r'
--     |    /
--     A --/
-- 
-- Theorem. r : A <- B がレトラクションならば任意の f : A <- C に対して g : B <- C が存在して r . g = f である
--          r
--     A <----- B
--     ^       ^^
--     |    r'/ |
--   id|     /  | g
--     |    /   |
--     A --+    C
--       <-----
--          f
-- Prove:
--  g = r' . f ととる
--
--  r . g
-- == {- g = r' . f -}
--  r . r' . f
-- == {- r はレトラクション -}
--  id_A . f
-- == {- 単位元 -}
--  f
--
-- レトラクションの双対
--   Def. s : B <- A は s' . s = id_A なる s' が存在するならセクションという
--         s
--     A -----> B
--     |       /
--   id|      / s'
--     |     /
--     v    /
--     A <-/
--
--   Theorem. s : B <- A がセクションならば任意の f : C <- A に対して g : C <- B が存在して g . s = f である
--
--         s
--     A -----> B
--     |       /|
--   id|    s'/ | g
--     |     /  |
--     v    /   v
--     A <-+    C
--       ----->
--         f
-- | Ex 2.4
-- m : B -> A , 任意の f, g : C -> B に対して f = g == m . f = m . g なら m はモノ
-- e : C -> B , 任意の f, g : B -> A に対して f = g == f . e = g . e なら e はエピ
--
-- f . g = id なら g はモノ
--
--  g . h = g . k
-- == {- Leibniz -}
--  f . (g . h) = f . (g . k)
-- == {- 合成は可換 -}
--  (f . g) . h = (f . g) . k
-- == {- f . g = id -}
--  id . h = id . k
-- == {- 単位元 -}
--  h = k
--
--
-- f . g = id なら f はエピを示す
--
--  h . f = k . f
-- == {- Leibniz -}
--  (h . f) . g = (k . f) . g
-- == {- 合成は可換 -}
--  h . (f . g) = k . (f . g)
-- == {- f . g = id -}
--  h . id = k . id
-- == {- 単位元 -}
--  h = k
--
-- | Ex 2.5
--
-- f . g がエピなら f がエピ
--
--  h . f = k . f
-- == {- Leibniz -}
--  (h . f) . g = (k . f) . g
-- == {- 合成は可換 -}
--  h . (f . g) = k . (f . g)
-- == {- f . g がエピ -}
--  h = k
--
-- 双対: f . g がモノなら g がモノ
--
--  g . h = g . k
-- == {- Leibniz -}
--  f . (g . h) = f . (g . k)
-- == {- 合成は可換 -}
--  (f . g) . h = (f . g) . k
-- == {- f . g がモノ -}
--  h = k
--
-- | Ex 2.6
--
-- 任意の射はただ最大でも1本しかない。(ex. 1 <= 3 などは 1 本, 5 <= 2 などは 0 本)
-- 任意の射 m : x <= y に対して任意の f, g : w <= x をとると
-- f = g == m . f = m . g なので任意の射 m はモノ
-- 同様に e : x <= y に対して任意の f, g : y <= w をとると
-- f = g == f . e = g . e なので任意の射 e はエピ
--
-- すべての射はモノかつエピだが同型射とは限らない
-- h : x <= x な射は h 自身が逆射となる
-- h . h = id
-- それ以外に逆射はない
--
-- | Ex 2.7
--
-- エピの定義を確認する.
-- e : C -> B , 任意の f, g : B -> A に対して f = g == f . e = g . e なら e はエピ
--
-- 上への関係 e のなかで f != g でも f . e = g . e となる e を見つければ良い
-- {0, 1} -> {0, 1} なる関係を考える.
-- e : {(0, 0), {0, 1}} とすると e は上への関係である.
-- S : {(0, 1), (1, 0)} および id {(0, 0), (1, 1)} に対して
-- S . e = {(0, 1), (0, 0)} = e
-- id . e = {(0, 0), (0, 1)} = e
-- なので S . e = id . e ではあるが S != id である.
-- したがって上への関係でもエピとはかぎらない.
--
-- Rel におけるエピ射は部分関数か?
-- No.
-- {0, 1, 2} -> {0, 1} な関係において e = {(0, 0), (0, 1), (2, 0), (1, 1)} を考える.
-- e は部分関数ではないがエピである.
-- f による 0 からの値域を f0, 1 からの値域を f1, g による 0 からの値域を g0, 1 からの値域を g0 とする.
-- すると f . e と g . e が同じになるということは 2 から到達する f0 と g0 が等しく, 1 から到達する f1 と g1 が等しく,
-- さらに 0 から到達する f0 \/ f1 と g0 \/ g1 が等しくなる.
-- つまり f . e = {(2, f_0), (0, f_0 \/ f_1), (1, f_1)} = g . e = {(2, g_0), (0, f_0 \/ f_1), (1, f_1)} なので
-- f_0 = g_0, f_1 = g_1, f_0 \/ f_1 = g_0 \/ g_1 である.
-- したがって f = {(0, f_0), (1, f_1)}, g = {(0, g_0), (1, g_1)} が等しくなり, f = g である.
-- 逆に f = g なら f_0 = g_0, f_1 = g_1 なので同様にポイントワイズに比較すれば f . e = g . e.
--
-- | Ex 2.8
--
--         h
--  A <---------- C
--  |             |
-- f|             |g
--  |             |
--  v             v
--  B <---------- D
--         k
--  (h, k) . (p, q) = (h, k) . (p', q') == (p, q) = (p', q')
-- ==
--  (h . p, k . q) = (h . p', k . q') == (p, q) = (p', q')
-- ==
--  h . p = h . p' and k . q = k . q' == p = p' and q = q'
--
--  つまり h とk がそれぞれ元の圏でモノであれば Arr(A) でモノである.
--
